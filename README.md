# VRChat Mute Controller

VRChatのOSC機能を利用して、マイクのミュート状態をキーボードショートカットで制御するアプリケーションです。

## 🚀 機能

- **ミュートトグル**: 指定したショートカットでミュート状態を切り替え
- **設定保存/読み込み**: ショートカット設定をJSONファイルで管理
- **システムトレイ**: 最小化時にタスクトレイに格納
- **ダークテーマUI**: 黒背景でMesloフォントを使用
- **シンプルな操作**: 1つのショートカットで簡単にミュート制御

## 📋 システム要件

- Windows 10/11
- Python 3.8以上
- VRChat（OSC機能有効）

## 🔧 インストール手順

### 1. Python環境の準備

Python 3.8以上がインストールされていることを確認してください。

### 2. 依存パッケージのインストール

```powershell
# 仮想環境の作成（推奨）
python -m venv venv

# 仮想環境の有効化
venv\Scripts\Activate.ps1

# 依存パッケージのインストール
pip install -r requirements.txt
```

### 3. Mesloフォントのインストール（推奨）

1. [Meslo LG フォント](https://github.com/andreberg/Meslo-Font/releases)をダウンロード
2. フォントファイルを右クリック → "インストール" をクリック
3. フォントがない場合は、アプリケーションがデフォルトフォントで動作します

## 🎮 VRChatでの設定

### 1. OSC機能を有効にする

1. VRChatを起動
2. 設定 → OSC → "Enabled" をONにする
3. ポート番号が9000であることを確認

### 2. Toggle Voice設定を確認

VRChatの設定で「Toggle Voice」の状態を確認してください：

- **Toggle Voice ON（推奨）**: ミュートトグルショートカットのみ使用
- **Toggle Voice OFF**: ミュートON/OFFショートカットを個別に使用

## 🖥️ 使用方法

### 1. アプリケーションの起動

```powershell
python main.py
```

### 2. ショートカットの設定

1. ショートカット欄に組み合わせを入力
   - デフォルト: `f12`（推奨）
   - カスタム例: `ctrl+shift+m`, `alt+f1`, `ctrl+alt+t`
2. 「設定を保存」をクリック
3. アプリケーションが自動的にショートカットを監視開始

### 3. 動作確認

- VRChatを起動した状態で設定したショートカットを押下
- 「動作状態」エリアで送信状況を確認

## ⚙️ 設定ファイル

設定は `vrchat_mute_config.json` に保存されます：

```json
{
  "mute_toggle_shortcut": "f12"
}
```

## 🔌 OSC通信詳細

### 送信先
- **IP**: 127.0.0.1
- **Port**: 9000
- **Address**: `/input/Voice`

### 送信値
- **ミュートトグル**: `1` → `0` (100ms間隔)

## 🛠️ トラブルシューティング

### よくある問題

1. **ショートカットが効かない**
   - 管理者権限で実行してみてください
   - 他のアプリケーションと競合していないか確認

2. **VRChatで反応しない**
   - VRChatでOSC機能が有効になっているか確認
   - ポート番号が9000であることを確認

3. **フォントが表示されない**
   - Mesloフォントがインストールされているか確認
   - フォントがなくても動作には影響しません

### エラーメッセージ

- **"ショートカット監視エラー"**: 無効なショートカット形式
- **"送信エラー"**: OSC通信エラー（VRChatが起動していない可能性）

## 🔄 アップデート

新しいバージョンがリリースされた場合：

1. 古いファイルをバックアップ
2. 新しいファイルをダウンロード
3. `vrchat_mute_config.json` を新しいディレクトリにコピー

## � スタートアップ設定（自動起動）

Windows起動時に自動でアプリケーションを起動したい場合：

1. **スタートアップフォルダに追加**
   - `Win + R` → `shell:startup` でスタートアップフォルダを開く
   - `VRChat_Mute_Controller.exe` のショートカットを作成
   - ショートカットをスタートアップフォルダにコピー
   - ショートカットのプロパティから「管理者として実行」を設定

### 注意事項

- 管理者権限が必要になることがあるため、UACプロンプトが表示される場合があります
- VRChatより先に起動することを推奨します
- 自動起動後はタスクトレイからアクセスできます

## �📝 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 🤝 サポート

問題が発生した場合：

1. 「動作状態」エリアでエラーメッセージを確認
2. VRChatとPythonの両方が正常に動作していることを確認
3. 設定ファイルを削除して初期状態から再設定

## 📋 ショートカット記法

ショートカットは以下の形式で入力してください：

- `ctrl+shift+m` (Ctrl + Shift + M)
- `alt+f1` (Alt + F1)
- `ctrl+alt+t` (Ctrl + Alt + T)
- `shift+f12` (Shift + F12)

利用可能なキー：
- 修飾キー: `ctrl`, `alt`, `shift`, `win`
- 文字キー: `a-z`, `0-9`
- ファンクションキー: `f1-f12`
- 特殊キー: `space`, `enter`, `tab`, `esc`
