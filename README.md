# VRChat Mute Controller

VRChatのOSC機能を利用して、マイクのミュート状態をキーボードショートカットで制御するアプリケーションです。

## VRChatでの設定

### 1. OSC機能を有効にする

1. VRChatを起動
2. 設定 → OSC → "Enabled" をONにする
3. ポート番号が9000であることを確認 ※動作しなかった場合に確認してください
   - デフォルトで9000が設定されています。変更されている場合は9000に戻してください。

### 2. マイク設定を確認

VRChatの設定で、オーディオ→マイクの動作の設定を確認し、**"切り替え"**に設定してください。
この設定により、ショートカットキーでマイクのミュート状態を切り替えることができます。

## 使用方法

### 1. アプリケーションの起動

1. `VRChat_Mute_Controller.exe` をダブルクリック
2. アプリケーションが起動し、システムトレイにアイコンが表示されます

※毎回起動するのが面倒な場合は、後述の手順でスタートアップに登録することを推奨します。

### 2. ショートカットの設定

1. ショートカット欄に組み合わせを入力
   - デフォルト: `ctrl+f12`
   - カスタム例: `ctrl+shift+m`, `alt+f1`, `ctrl+alt+t`
2. 「設定を保存」をクリック
3. アプリケーションが自動的にショートカットの監視を開始します

### 3. 動作確認

- VRChatを起動した状態で設定したショートカットを押下
- 「動作状態」エリアで送信状況を確認
- VRChat内でマイクのミュート状態が切り替わることを確認
- ウィンドウを閉じてもタスクトレイから操作可能です

## 設定ファイル

設定は `vrchat_mute_config.json` に保存されます：

```json
{
  "mute_toggle_shortcut": "ctrl+f12"
}
```

## OSC通信詳細

### 送信先
- **IP**: 127.0.0.1
- **Port**: 9000
- **Address**: `/input/Voice`

## システムトレイ機能

- アプリケーションのウィンドウを閉じても、システムトレイで動作し続けます
- トレイアイコンを右クリックして「表示」でウィンドウを再表示できます
- 完全に終了するには、トレイアイコンを右クリックして「終了」を選択してください

## トラブルシューティング

### よくある問題

1. **ショートカットが効かない**
   - アプリケーションを管理者権限で実行してみてください
   - 他のアプリケーションとショートカットが競合していないか確認してください
   - 「ショートカット再設定」ボタンを押してみてください

2. **VRChatで反応しない**
   - VRChatでOSC機能が有効になっているか確認してください
   - ポート番号が9000であることを確認してください
   - VRChatのマイク設定が「切り替え」になっているか確認してください

3. **アプリケーションが起動しない**
   - Windows Defenderやウイルス対策ソフトでブロックされていないか確認してください
   - EXEファイルを右クリックして「管理者として実行」を試してください

### エラーメッセージ

- **"ショートカット監視エラー"**: 無効なショートカット形式です。正しい形式で入力してください
- **"送信エラー"**: OSC通信エラーです（VRChatが起動していない可能性があります）
- **"設定保存エラー"**: 設定ファイルの保存に失敗しました（書き込み権限を確認してください）

## アップデート

新しいバージョンがリリースされた場合：

1. 古いアプリケーションを終了してください（システムトレイからも終了）
2. 古いファイルをバックアップしてください
3. 新しい `VRChat_Mute_Controller.exe` をダウンロードして置き換えてください
4. 設定ファイル（`vrchat_mute_config.json`）は自動的に引き継がれます

## スタートアップ設定（自動起動）

Windows起動時に自動でアプリケーションを起動したい場合：

1. **スタートアップフォルダに追加**
   - `Win + R` → `shell:startup` でスタートアップフォルダを開く
   - `VRChat_Mute_Controller.exe` のショートカットを作成
   - ショートカットをスタートアップフォルダにコピー
   - ショートカットのプロパティから「管理者として実行」を設定

### 注意事項

- 管理者権限が必要になることがあるため、UACプロンプトが表示される場合があります
- VRChatより先に起動することを推奨します
- 自動起動後はタスクトレイからアクセスできます

##  ライセンス

このプロジェクトはMITライセンスの下で公開されています。

### 使用ライブラリのライセンス

このアプリケーションは以下のサードパーティライブラリを使用しています：

- **customtkinter**: MIT License
- **python-osc**: Unlicense (パブリックドメイン)
- **keyboard**: MIT License
- **pystray**: LGPL-3.0
- **Pillow**: MIT-CMU License
- **setuptools**: MIT License
- **PyInstaller**: GPL-2.0 with special exception

詳細なライセンス情報については、`LICENSE_NOTICES.md` ファイルをご確認ください。

## ショートカット記法

ショートカットは以下の形式で入力してください：

- `ctrl+f12` (Ctrl + F12) - デフォルト
- `ctrl+shift+m` (Ctrl + Shift + M)
- `alt+f1` (Alt + F1)
- `ctrl+alt+t` (Ctrl + Alt + T)
- `shift+f12` (Shift + F12)

利用可能なキー：
- 修飾キー: `ctrl`, `alt`, `shift`, `win`
- 文字キー: `a-z`, `0-9`
- ファンクションキー: `f1-f12`
- 特殊キー: `space`, `enter`, `tab`, `esc`
